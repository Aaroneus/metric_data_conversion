mw.loader.implement("ext.uls.interface",function(){(function($,mw){'use strict';function displaySettings(){var $displaySettingsTitle,displaySettingsText,$displaySettings;displaySettingsText=$.i18n('ext-uls-display-settings-desc');$displaySettingsTitle=$('<div data-i18n="ext-uls-display-settings-title">').addClass('settings-title').attr('title',displaySettingsText);$displaySettings=$('<div>').addClass('display-settings-block').prop('id','display-settings-block').append($displaySettingsTitle.i18n());return $displaySettings;}function inputSettings(){var $inputSettingsTitle,inputSettingsText,$inputSettings;inputSettingsText=$.i18n('ext-uls-input-settings-desc');$inputSettingsTitle=$('<div data-i18n="ext-uls-input-settings-title">').addClass('settings-title').attr('title',inputSettingsText);$inputSettings=$('<div>').addClass('input-settings-block').prop('id','input-settings-block').append($inputSettingsTitle.i18n());return $inputSettings;}function addDisplaySettings(uls){var $displaySettings
=displaySettings();uls.$menu.find('#settings-block').append($displaySettings);$displaySettings.on('click',function(){var languagesettings=$displaySettings.data('languagesettings'),displaySettingsOptions={defaultModule:'display'},ulsPosition=mw.config.get('wgULSPosition'),anonMode=(mw.user.isAnon()&&!mw.config.get('wgULSAnonCanChangeLanguage'));if(!languagesettings){if(ulsPosition==='personal'&&!anonMode){displaySettingsOptions.onClose=function(){uls.show();};}$.extend(displaySettingsOptions,uls.position());mw.loader.using(mw.uls.languageSettingsModules,function(){$displaySettings.languagesettings(displaySettingsOptions).click();});}mw.hook('mw.uls.settings.open').fire('uls');uls.hide();});}function addInputSettings(uls){var $inputSettings=inputSettings();uls.$menu.find('#settings-block').append($inputSettings);$inputSettings.on('click',function(){var position=uls.position(),languagesettings=$inputSettings.data('languagesettings');if(!languagesettings){mw.loader.using(mw.uls.
languageSettingsModules,function(){$inputSettings.languagesettings({defaultModule:'input',onClose:function(){uls.show();},top:position.top,left:position.left}).click();});}mw.hook('mw.uls.settings.open').fire('uls');uls.hide();});}function addAccessibilityFeatures($target){$target.attr({tabIndex:0,role:'button','aria-haspopup':true});$target.click(function(){$(this).css('outline','none');});$target.blur(function(){$(this).css('outline','');});$target.keydown(function(event){if(event.keyCode===13){$(this).click();event.preventDefault();event.stopPropagation();}});}function showULSTooltip(){var ulsPosition=mw.config.get('wgULSPosition'),currentLang=mw.config.get('wgUserLanguage'),previousLang,previousLanguageAutonym,$ulsTrigger,anonMode,rtlPage=$('body').hasClass('rtl'),tipsyGravity={personal:'n',interlanguage:rtlPage?'e':'w'},previousLanguages=mw.uls.getPreviousLanguages()||[];previousLang=previousLanguages.slice(-1)[0];$ulsTrigger=(ulsPosition==='interlanguage')?$(
'.uls-settings-trigger'):$('.uls-trigger');if(previousLang===currentLang){$ulsTrigger.tipsy({gravity:rtlPage?'e':'w'});return;}previousLanguages.push(currentLang);mw.uls.setPreviousLanguages(previousLanguages);anonMode=(mw.user.isAnon()&&!mw.config.get('wgULSAnonCanChangeLanguage'));if(anonMode||!previousLang){return;}previousLanguageAutonym=$.cookie(mw.uls.previousLanguageAutonymCookie)||previousLang;$ulsTrigger.tipsy({gravity:tipsyGravity[ulsPosition],delayOut:3000,html:true,fade:true,trigger:'manual',title:function(){var link;link=$('<a>').text(previousLanguageAutonym).attr({href:'#','class':'uls-prevlang-link',lang:previousLang,dir:'auto'});link=$('<div>').html(link).html();return mw.msg('ext-uls-undo-language-tooltip-text',link);}});$.cookie(mw.uls.previousLanguageAutonymCookie,mw.config.get('wgULSCurrentAutonym'),{path:'/'});function showTipsy(timeout){var tipsyTimer=0;$ulsTrigger.tipsy('show');$('.tipsy').on('mouseover',function(){window.clearTimeout(tipsyTimer);});$('.tipsy').
on('mouseout',function(){tipsyTimer=window.setTimeout(function(){hideTipsy();},timeout);});$('a.uls-prevlang-link').on('click.ulstipsy',function(event){var deferred=$.Deferred();event.preventDefault();deferred.done(function(){mw.uls.changeLanguage(event.target.lang);});mw.hook('mw.uls.language.revert').fire(deferred);window.setTimeout(function(){deferred.resolve();},mw.config.get('wgULSEventLogging')*500);});tipsyTimer=window.setTimeout(function(){hideTipsy();},timeout);}function hideTipsy(){$ulsTrigger.tipsy('hide');}window.setTimeout(function(){showTipsy(6000);},700);$ulsTrigger.on('mouseover',function(){if(!$('.uls-menu:visible').length){showTipsy(3000);}});$ulsTrigger.on('click',function(){hideTipsy();});}$(document).ready(function(){mw.uls.init(function(){var $triggers,$pLang,$ulsTrigger=$('.uls-trigger'),rtlPage=$('body').hasClass('rtl'),anonMode=(mw.user.isAnon()&&!mw.config.get('wgULSAnonCanChangeLanguage')),imeSelector=mw.config.get('wgULSImeSelectors').join(', '),ulsPosition=
mw.config.get('wgULSPosition');if(ulsPosition==='interlanguage'){$pLang=$('#p-lang');$ulsTrigger=$('<span>').addClass('uls-settings-trigger');$pLang.show().prepend($ulsTrigger);$ulsTrigger=$('.uls-settings-trigger');$pLang.find('.uls-p-lang-dummy').remove();if(!$pLang.find('div ul').children().length){$pLang.find('h3').text(mw.msg('uls-plang-title-languages'));if(mw.config.get('skin')==='monobook'){$pLang.find('div.pBody').remove();}}$ulsTrigger.attr({title:mw.msg('ext-uls-select-language-settings-icon-tooltip')});$ulsTrigger.on('click',function(e,eventParams){var languagesettings=$ulsTrigger.data('languagesettings'),languageSettingsOptions;if(languagesettings){if(!languagesettings.shown){mw.hook('mw.uls.settings.open').fire(eventParams&&eventParams.source||'interlanguage');}}else{languageSettingsOptions={defaultModule:'display',onVisible:function(){var topRowHeight,caretHeight,caretWidth,$caretBefore=$('<span>').addClass('caret-before'),$caretAfter=$('<span>').addClass('caret-after'),
ulsTriggerWidth=this.$element.width(),ulsTriggerOffset=this.$element.offset();this.$window.addClass('callout');this.$window.prepend($caretBefore,$caretAfter);if(rtlPage){caretWidth=parseInt($caretBefore.css('border-left-width'),10);this.left=ulsTriggerOffset.left-this.$window.width()-caretWidth;}else{caretWidth=parseInt($caretBefore.css('border-right-width'),10);this.left=ulsTriggerOffset.left+ulsTriggerWidth+caretWidth;}topRowHeight=this.$window.find('.row').height();caretHeight=parseInt($caretBefore.css('top'),10);this.top=ulsTriggerOffset.top-topRowHeight-caretHeight/2;this.position();}};mw.loader.using(mw.uls.languageSettingsModules,function(){$ulsTrigger.languagesettings(languageSettingsOptions).click();});e.stopPropagation();}});}else if(anonMode){$ulsTrigger.on('click',function(e,eventParams){var languagesettings=$ulsTrigger.data('languagesettings');if(languagesettings){if(!languagesettings.shown){mw.hook('mw.uls.settings.open').fire(eventParams&&eventParams.source||'personal');
}}else{mw.loader.using(mw.uls.languageSettingsModules,function(){$ulsTrigger.languagesettings();$ulsTrigger.trigger('click',eventParams);});e.stopPropagation();}});}else{$ulsTrigger.on('click',function(e,eventParams){var uls=$ulsTrigger.data('uls');if(uls){if(!uls.shown){mw.hook('mw.uls.settings.open').fire(eventParams&&eventParams.source||'personal');}}else{mw.loader.using('ext.uls.mediawiki',function(){$ulsTrigger.uls({quickList:function(){return mw.uls.getFrequentLanguageList();},onReady:function(){var uls=this;mw.loader.using(mw.uls.languageSettingsModules,function(){addDisplaySettings(uls);addInputSettings(uls);});},onSelect:function(language){mw.uls.changeLanguage(language);},onVisible:function(){mw.uls.addEventLoggingTriggers();}});window.setTimeout(function(){$ulsTrigger.trigger('click',eventParams);},0);e.stopPropagation();});}});}$triggers=$('.uls-settings-trigger, .uls-trigger');addAccessibilityFeatures($triggers);$('#uls-preferences-link').text(mw.msg(
'ext-uls-language-settings-preferences-link')).click(function(){$ulsTrigger.trigger('click',{source:'preferences'});return false;});showULSTooltip();$('body').on('focus.imeinit',imeSelector,function(){var $input=$(this);$('body').off('.imeinit');mw.loader.using('ext.uls.ime',function(){mw.ime.setup();mw.ime.handleFocus($input);});});});});}(jQuery,mediaWiki));;},{},{"ext-uls-language-settings-preferences-link":"More language settings","ext-uls-select-language-settings-icon-tooltip":"Language settings","ext-uls-undo-language-tooltip-text":"Language changed from $1","uls-plang-title-languages":"Languages"});mw.loader.implement("ext.uls.webfonts",function(){(function($,mw){'use strict';var ulsPreferences,tofuSalt='\u0D00',tofuLanguages={};mw.webfonts=mw.webfonts||{};ulsPreferences=mw.uls.preferences();mw.webfonts.preferences={registry:{fonts:{},webfontsEnabled:mw.config.get('wgULSWebfontsEnabled')},isEnabled:function(){return this.registry.webfontsEnabled;},enable:function(){this.registry
.webfontsEnabled=true;},disable:function(){this.registry.webfontsEnabled=false;},setFont:function(language,font){this.registry.fonts[language]=font;},getFont:function(language){return this.registry.fonts[language];},save:function(callback){ulsPreferences=mw.uls.preferences();ulsPreferences.set('webfonts',this.registry);ulsPreferences.save(callback);},load:function(){mw.webfonts.preferences.registry=$.extend(this.registry,ulsPreferences.get('webfonts'));}};function detectTofu(text){var index,$fixture,width={},height={},length=Math.min(4,text.length),detected=false;if($.client.test({msie:false})){text=tofuSalt+text;}$fixture=$('<span>').css({fontSize:'72px',fontFamily:'sans-serif'}).appendTo('body');for(index=0;index<length;index++){$fixture.text(text[index]);width[index]=$fixture.width()||width[index-1];height[index]=$fixture.height();if(index>0&&(width[index]!==width[index-1]||height[index]!==height[index-1])){detected=false;break;}}$fixture.remove();if(index===length){detected=true;}
return detected;}mw.webfonts.setup=function(){var mediawikiFontRepository=$.webfonts.repository;mediawikiFontRepository.base=mw.config.get('wgULSFontRepositoryBasePath');$.extend($.fn.webfonts.defaults,{repository:mediawikiFontRepository,fontStack:$('body').css('font-family').split(/, /g),exclude:mw.config.get('wgULSNoWebfontsSelectors').join(', ')});$.fn.webfonts.defaults=$.extend($.fn.webfonts.defaults,{fontSelector:function(repository,language,classes){var font,tofu,autonym,defaultFont;if(!language){return null;}defaultFont=repository.defaultFont(language);if(classes&&$.inArray('autonym',classes)>=0){autonym=true;}font=mw.webfonts.preferences.getFont(language);if(!font||autonym){if((!defaultFont||defaultFont==='system')&&!autonym){return font;}tofu=tofuLanguages[language]||detectTofu($.uls.data.getAutonym(language));if(tofu){mw.log('tofu detected for '+language);tofuLanguages[language]=true;font=autonym?'Autonym':defaultFont;}else{font='system';}}if(font==='system'){font=null;}
return font;},exclude:(function(){var excludes=$.fn.webfonts.defaults.exclude;if(mw.user.options.get('editfont')!=='default'){excludes=(excludes)?excludes+',textarea':'textarea';}return excludes;}())});setTimeout(function(){$('body').webfonts();$('body').data('webfonts').load('Autonym');},0);};$(document).ready(function(){mw.uls.init(function(){mw.webfonts.preferences.load();if(mw.webfonts.preferences.isEnabled()){mw.loader.using('ext.uls.webfonts.fonts',mw.webfonts.setup);}});});}(jQuery,mediaWiki));;},{},{});
/* cache key: enwiki:resourceloader:filter:minify-js:7:8bf56f0c7a9a44623ce0ac3a7a7bdbfd */